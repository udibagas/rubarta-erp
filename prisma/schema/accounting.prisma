enum Currency {
  IDR
  USD
}

model Supplier {
  id          Int        @id @default(autoincrement())
  code        String?    @db.Char(6)
  name        String
  address     String
  phone       String?
  email       String?
  Bank        Bank       @relation(fields: [bankId], references: [id])
  bankAccount String
  currency    Currency
  bankId      Int
  Nkp         Nkp[]
  Material    Material[]

  @@map("Suppliers")
}

model Account {
  id      Int       @id @default(autoincrement())
  code    String    @unique
  name    String
  type    String
  balance Decimal
  Expense Expense[]

  @@map("Accounts")
}

enum InvoiceStatus {
  Draft
  Pending
  Paid
  Overdue
}

model Invoice {
  id          Int           @id @default(autoincrement())
  number      String        @unique
  date        DateTime
  dueDate     DateTime
  status      InvoiceStatus
  attachments Json?         @db.JsonB // Attachments related to the invoice

  // financials
  totalAmount Float
  vatAmount   Float
  grandTotal  Float

  // Relationships
  userId     Int
  orderId    Int @unique
  customerId Int

  Customer     Customer      @relation(fields: [customerId], references: [id])
  Payments     Payment[]
  Order        Order         @relation(fields: [orderId], references: [id])
  User         User          @relation(fields: [userId], references: [id])
  InvoiceItems InvoiceItem[]

  // Timestamps
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("Invoices")
}

model InvoiceItem {
  id          Int     @id @default(autoincrement())
  invoiceId   Int
  description String
  quantity    Int
  unitPrice   Float
  totalPrice  Float
  vat         Boolean @default(false) // Indicates if VAT is applicable

  // Relationships
  Invoice Invoice @relation(fields: [invoiceId], references: [id])

  @@map("InvoiceItems")
}

model Payment {
  id          Int      @id @default(autoincrement())
  date        DateTime
  amountPaid  Decimal
  remarks     String?
  attachments Json?    @db.JsonB // Attachments related to the payment

  // Relationships
  invoiceId Int
  userId    Int

  Invoice Invoice @relation(fields: [invoiceId], references: [id])
  User    User    @relation(fields: [userId], references: [id])

  // Timestamps
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("Payments")
}

model Expense {
  id          Int      @id @default(autoincrement())
  date        DateTime
  description String
  amount      Decimal
  accountId   Int
  account     Account  @relation(fields: [accountId], references: [id])
}
